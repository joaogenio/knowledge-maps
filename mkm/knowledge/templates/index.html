{% extends "base.html" %}

{% block title %}<title>Knowledge App - Index</title>{% endblock %}

{% block content %}

<h1>Add Author</h1>
<form method="post">
    {% csrf_token %}
    {{ authorform }}
    <input name="add-author" type="submit" value="Submit">
</form>

<h1>All Authors</h1>

{% if True %}
{% else %}
{% endif %}

{% for author in authors %}

<!-- FORMS -->
<table>
    <tr>
        <td>
            <form method="post">
                {% csrf_token %}
                <input name="author_pk" type="hidden" value="{{ author.id }}" />
                <input name="sync-scopus-author" type="submit" value="Sync Scopus Author Data">
            </form>
        </td>
        <td>
            <form method="post">
                {% csrf_token %}
                <input name="author_pk" type="hidden" value="{{ author.id }}" />
                <input name="sync-scopus-docs" type="submit" value="Sync Scopus Documents">
            </form>
        </td>
        <td>
            <form method="post">
                {% csrf_token %}
                <input name="author_pk" type="hidden" value="{{ author.id }}" />
                <input name="sync-ciencia" type="submit" value="Sync Ciência">
            </form>
        </td>
        <td>
            <form method="post">
                {% csrf_token %}
                <input name="author_pk" type="hidden" value="{{ author.id }}" />
                <input name="delete_author" type="submit" value="Delete Author">
            </form>
        </td>
    </tr>
</table>

<table class="author">

    <tr>
        <td class="bold">
            Photo
        </td>
        <td>
            <img src="https://www.cienciavitae.pt/fotos/publico/{{author.ciencia_id}}.jpg">
        </td>
    </tr>

    <tr><td class="bold
        {% if author.name == "" %}
            ">Name</td><td class="">
        {% elif author.synced_ciencia %}
            ciencia">Name</td><td class="ciencia">{{author.name}}
        {% else %}
            scopus">Name</td><td class="scopus">{{author.name}}
        {% endif %}
    </td></tr>

    <tr><td class="bold">Scopus ID</td><td>
        {% if author.scopus_id != None %}
            <a href="https://www.scopus.com/authid/detail.uri?authorId={{author.scopus_id}}">
                {{author.scopus_id}}
            </a>
        {% endif %}
    </td></tr>

    <tr><td class="bold">Ciência ID</td><td>
        {% if author.ciencia_id != None %}
            <a href="https://www.cienciavitae.pt//{{author.ciencia_id}}">
                {{author.ciencia_id}}
            </a>
        {% endif %}
    </td></tr>

    <tr><td class="bold">ORCID ID</td><td>
        {% if author.orcid_id != None %}
            <a href="https://orcid.org/{{author.orcid_id}}">
                {{author.orcid_id}}
            </a>
        {% endif %}
    </td></tr>

    <tr><td class="scopus bold">Name List</td><td class="scopus">
        {% if author.load_name_list|length == 0 %}
            
        {% else %}
            {{author.load_name_list}}
        {% endif %}
    </td></tr>

    <tr><td class="scopus bold">H-index</td><td class="scopus">
        {% if author.h_index == None %}
            
        {% else %}
            {{author.h_index}}
        {% endif %}
    </td></tr>

    <tr><td class="scopus bold">Citation Count</td><td class="scopus">
        {% if author.citation_count == 0 %}
            
        {% else %}
            {{author.citation_count}}
        {% endif %}
    </td></tr>

    <tr><td class="scopus bold">Cited-by Count</td><td class="scopus">
        {% if author.cited_by_count == 0 %}
            
        {% else %}
            {{author.cited_by_count}}
        {% endif %}
    </td></tr>

    <tr><td class="scopus bold">Current Affiliations</td><td class="scopus">
        {% if author.current_affiliations.all|length == 0 %}
            
        {% else %}
            {% for affiliation in author.current_affiliations.all %}
                {{affiliation.name}}<br>
            {% endfor %}
        {% endif %}
    </td></tr>

    <tr><td class="scopus bold">Previous Affiliations</td><td class="scopus">
        {% if author.previous_affiliations.all|length == 0 %}
            
        {% else %}
            <details>
                <summary>
                    {{author.previous_affiliations.all|length}} Affiliations
                </summary>
                <p>
                    {% for affiliation in author.previous_affiliations.all %}
                        {{affiliation.name}}<br>
                    {% endfor %}
                </p>
            </details>
        {% endif %}
    </td></tr>
    
    <tr><td class="ciencia bold">Bio</td><td class="ciencia">
        {% if author.bio == "" %}
            
        {% else %}
            <details>
                <summary>
                    Available
                </summary>
                <p>
                    {{author.bio}}
                </p>
            </details>
        {% endif %}
    </td></tr>

    <tr><td class="ciencia bold">Degrees</td><td class="ciencia">
        {% if author.load_degrees|length == 0 %}
            
        {% else %}
            <details>
                <summary>
                    {{author.load_degrees|length}} Degrees
                </summary>
                <p>
                    {{author.load_degrees}}
                </p>
            </details>
        {% endif %}
    </td></tr>
    
    <tr><td class="ciencia bold">Distinctions</td><td class="ciencia">
        {% if author.load_distinctions|length == 0 %}
            
        {% else %}
            <details>
                <summary>
                    {{author.load_distinctions|length}} Distinctions
                </summary>
                <p>
                    {{author.load_distinctions}}
                </p>
            </details>
        {% endif %}
    </tr>
    
    <tr><td class="ciencia bold">Projects</td>
        <td class="ciencia">
            {% if author.projects.all|length == 0 %}
                
            {% else %}
                <details>
                    <summary>
                        {{author.projects.all|length}} Projects
                    </summary>
                    <p>
                        <table class="noborder">
                            {% for project in author.projects.all %}
                                <tr>
                                    <td>{{project.date}}</td>
                                    <td class="bold">{{project.name}}</td>
                                </tr>
                            {% endfor %}
                        </table>
                    </p>
                </details>
            {% endif %}
        </td>
    </tr>
    
    <tr><td class="bold">Domains</td>
        <td>
            {% if author.domains.all|length == 0 %}
                
            {% else %}
                <details>
                    <summary>
                        {{author.domains.all|length}} Domains
                    </summary>
                    <p>
                        {% for area in author.domains.all %}
                            {{area.name}}<br>
                        {% endfor %}
                    </p>
                </details>
            {% endif %}
        </td>
    </tr>

    <tr><td class="bold">Publications</td>
        <td>
            {% if author.publications.all|length == 0 %}
                
            {% else %}
                <details>
                    <summary>
                        {{author.publications.all|length}} Publications
                    </summary>
                    <p>
                        <table class="noborder">
                            {% for publication in author.publications.all %}
                                <tr>
                                    {% if publication.author_set.all|length != 1 %}
                                        <td class="">
                                            <p
                                                title="{% for author in publication.author_set.all %}{{author.name}}     {% endfor %}"
                                                class="inline">
                                                {{publication.author_set.all|length}} Authors
                                            </p>
                                        </td>
                                    {% else %}
                                        <td></td>
                                    {% endif %}
                                    {% if publication.load_keywords|length != 0 %}
                                        <td class="orange">
                                            <p
                                                title="{{publication.load_keywords}}"
                                                class="inline">
                                                {{publication.load_keywords|length}} Keywords
                                            </p>
                                        </td>
                                    {% else %}
                                        <td></td>
                                    {% endif %}
                                    {% if publication.areas.all|length != 0 %}
                                        <td class="red">
                                            <p
                                                title="{% for area in publication.areas.all %}{{area.name}}     {% endfor %}"
                                                class="inline">
                                                {{publication.areas.all|length}} Areas
                                            </p>
                                        </td>
                                    {% else %}
                                        <td></td>
                                    {% endif %}
                                    {% if publication.abstract != "" %}
                                        <td class="red">
                                            <p
                                                title="{{publication.abstract}}"
                                                class="inline">
                                                Abstract
                                            </p>
                                        </td>
                                    {% else %}
                                        <td></td>
                                    {% endif %}
                                    {% if publication.available %}
                                        <td class="red">
                                            <p
                                                class="inline">
                                                Full Text
                                            </p>
                                        </td>
                                    {% else %}
                                        <td></td>
                                    {% endif %}
                                    <td><p class="inline">{{publication.date}}</p></td>
                                    <td class="bold"><p>{{publication.title}}</p></td>
                                </tr>
                            {% endfor %}
                        </table>
                    </p>
                </details>
            {% endif %}
        </td>
    </tr>
    
</table>
<br>
{% endfor %}

{% endblock %}

{% block scripts %}

{% endblock %}